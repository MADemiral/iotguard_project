{
  "model_info": {
    "name": "IoTGuard Ultra Advanced 2-Stage Ensemble",
    "version": "2.0",
    "architecture": "2-Stage: Binary + Multi-Class Classification",
    "created_at": "2025-12-14T22:52:53.551283",
    "training_duration": "0:08:14.369137",
    "framework": "LightGBM + XGBoost + CatBoost + TensorFlow",
    "dataset": "CIC-IoT-2023"
  },
  "training_data": {
    "train_samples": 369535,
    "val_samples": 256892,
    "test_samples": 263098,
    "train_files": 11,
    "val_files": 4,
    "test_files": 4,
    "dataset_name": "CIC-IoT-2023"
  },
  "stage1_binary": {
    "purpose": "Binary classification (Benign vs Attack)",
    "models": [
      "lightgbm",
      "xgboost"
    ],
    "ensemble_weights": {
      "lightgbm": 0.5,
      "xgboost": 0.5,
      "catboost": 0.0,
      "neural_network": 0.0
    },
    "performance": {
      "accuracy": 0.8976693095348501,
      "precision": 0.8942400924718549,
      "recall": 0.9750989583333334,
      "f1_score": 0.9329207371917052,
      "mcc": 0.7310493111470653,
      "confusion_matrix": [
        [
          48956,
          22142
        ],
        [
          4781,
          187219
        ]
      ]
    },
    "hyperparameters": {
      "lightgbm": {
        "enabled": true,
        "num_leaves": 95,
        "max_depth": 13,
        "learning_rate": 0.024,
        "n_estimators": 520,
        "min_child_samples": 18,
        "subsample": 0.8,
        "colsample_bytree": 0.8,
        "reg_alpha": 0.025,
        "reg_lambda": 0.025,
        "class_weight": "balanced",
        "is_unbalance": true
      },
      "xgboost": {
        "enabled": true,
        "max_depth": 13,
        "learning_rate": 0.024,
        "n_estimators": 520,
        "min_child_weight": 4,
        "subsample": 0.8,
        "colsample_bytree": 0.8,
        "gamma": 0.025,
        "reg_alpha": 0.025,
        "reg_lambda": 0.18,
        "scale_pos_weight": 5.0,
        "tree_method": "hist",
        "device": "cuda"
      },
      "catboost": {
        "enabled": false,
        "depth": 11,
        "learning_rate": 0.025,
        "iterations": 650,
        "l2_leaf_reg": 3.0,
        "border_count": 128,
        "random_strength": 0.5
      },
      "neural_network": {
        "enabled": false,
        "hidden_layers": [
          256,
          128,
          64,
          32
        ],
        "dropout_rate": 0.3,
        "activation": "relu",
        "optimizer": "adam",
        "learning_rate": 0.001,
        "batch_size": 1024,
        "epochs": 50,
        "early_stopping_patience": 10
      }
    }
  },
  "stage2_multiclass": {
    "purpose": "Multi-class attack categorization",
    "models": [
      "lightgbm",
      "xgboost"
    ],
    "ensemble_weights": {
      "lightgbm": 0.48,
      "xgboost": 0.52,
      "catboost": 0.0
    },
    "attack_categories": [
      "BruteForce",
      "DDoS-DoS",
      "Mirai",
      "Reconnaissance",
      "Spoofing",
      "Web-Based"
    ],
    "n_classes": 6,
    "performance": {
      "accuracy": 0.9130163071055822,
      "precision": 0.9136004968669523,
      "recall": 0.9130163071055822,
      "f1_score": 0.9128116007122709,
      "confusion_matrix": [
        [
          29317,
          0,
          0,
          745,
          254,
          920
        ],
        [
          0,
          31966,
          32,
          2,
          0,
          0
        ],
        [
          0,
          19,
          31980,
          0,
          1,
          0
        ],
        [
          2172,
          0,
          0,
          22805,
          703,
          3762
        ],
        [
          574,
          0,
          0,
          947,
          27927,
          1478
        ],
        [
          1271,
          0,
          0,
          2894,
          511,
          26939
        ]
      ]
    },
    "hyperparameters": {
      "lightgbm": {
        "enabled": true,
        "num_leaves": 100,
        "max_depth": 14,
        "learning_rate": 0.02,
        "n_estimators": 600,
        "min_child_samples": 3,
        "subsample": 0.82,
        "colsample_bytree": 0.82,
        "reg_alpha": 0.018,
        "reg_lambda": 0.018,
        "class_weight": "balanced",
        "is_unbalance": true
      },
      "xgboost": {
        "enabled": true,
        "max_depth": 14,
        "learning_rate": 0.02,
        "n_estimators": 600,
        "min_child_weight": 1,
        "subsample": 0.82,
        "colsample_bytree": 0.82,
        "gamma": 0.018,
        "reg_alpha": 0.018,
        "reg_lambda": 0.13,
        "tree_method": "hist",
        "device": "cuda"
      },
      "catboost": {
        "enabled": false,
        "depth": 11,
        "learning_rate": 0.02,
        "iterations": 700,
        "l2_leaf_reg": 3.0,
        "border_count": 128,
        "random_strength": 0.5,
        "class_weights": [
          1,
          1,
          1,
          1,
          1,
          1
        ]
      }
    }
  },
  "full_pipeline": {
    "accuracy": 0.6496970710533717,
    "precision": 0.6658300204626124,
    "recall": 0.6496970710533717,
    "f1_score": 0.6569245246704389,
    "benign_detection_rate": 1.0,
    "attack_detection_rate": 0.9750989583333334,
    "total_test_samples": 263098,
    "benign_samples": 71098,
    "attack_samples": 192000
  },
  "feature_engineering": {
    "original_features": 39,
    "engineered_features": 29,
    "total_features": 68,
    "feature_types": {
      "statistical": true,
      "time_based": true,
      "polynomial": false
    }
  },
  "files": {
    "stage1_model": "models/train_ultra_advanced_models/ultra_advanced_stage1_ensemble.pkl",
    "stage2_model": "models/train_ultra_advanced_models/ultra_advanced_stage2_ensemble.pkl",
    "config": "config_train_ultra_advanced.yaml",
    "results_dir": "results/train_ultra_advanced_results/"
  },
  "stage1_nn": {},
  "model_inputs": {
    "stage1": {
      "description": "Binary classification (Benign vs Attack)",
      "input_features": [
        "Header_Length",
        "Protocol Type",
        "Time_To_Live",
        "Rate",
        "fin_flag_number",
        "syn_flag_number",
        "rst_flag_number",
        "psh_flag_number",
        "ack_flag_number",
        "ece_flag_number",
        "cwr_flag_number",
        "ack_count",
        "syn_count",
        "fin_count",
        "rst_count",
        "HTTP",
        "HTTPS",
        "DNS",
        "Telnet",
        "SMTP",
        "SSH",
        "IRC",
        "TCP",
        "UDP",
        "DHCP",
        "ARP",
        "ICMP",
        "IGMP",
        "IPv",
        "LLC",
        "Tot sum",
        "Min",
        "Max",
        "AVG",
        "Std",
        "Tot size",
        "IAT",
        "Number",
        "Variance",
        "syn_ack_ratio",
        "rst_fin_ratio",
        "psh_ack_ratio",
        "packet_rate_ratio",
        "size_per_packet",
        "avg_iat",
        "variance_avg_ratio",
        "std_avg_ratio",
        "range_stat",
        "cv",
        "flags_total",
        "flag_diversity",
        "tcp_http_combo",
        "udp_dns_combo",
        "protocol_count",
        "ttl_rate_ratio",
        "header_size_ratio",
        "syn_count_ratio",
        "ack_count_ratio",
        "fin_count_ratio",
        "rst_count_ratio",
        "rate_ttl_interaction",
        "size_rate_interaction",
        "log_rate",
        "log_tot_size",
        "log_number",
        "iat_variance",
        "iat_std",
        "burst_score"
      ],
      "num_features": 68,
      "feature_types": {
        "original": [
          "Header_Length",
          "Protocol Type",
          "Time_To_Live",
          "Rate",
          "fin_flag_number",
          "syn_flag_number",
          "rst_flag_number",
          "psh_flag_number",
          "ack_flag_number",
          "ece_flag_number",
          "cwr_flag_number",
          "ack_count",
          "syn_count",
          "fin_count",
          "rst_count",
          "HTTP",
          "HTTPS",
          "DNS",
          "Telnet",
          "SMTP",
          "SSH",
          "IRC",
          "TCP",
          "UDP",
          "DHCP",
          "ARP",
          "ICMP",
          "IGMP",
          "IPv",
          "LLC",
          "Tot sum",
          "Min",
          "Max",
          "AVG",
          "Std",
          "Tot size",
          "IAT",
          "Number",
          "Variance",
          "size_per_packet",
          "avg_iat",
          "flags_total",
          "protocol_count",
          "iat_variance",
          "iat_std"
        ],
        "engineered_statistical": [
          "syn_ack_ratio",
          "rst_fin_ratio",
          "psh_ack_ratio",
          "packet_rate_ratio",
          "variance_avg_ratio",
          "std_avg_ratio",
          "range_stat",
          "cv",
          "flag_diversity",
          "ttl_rate_ratio",
          "header_size_ratio",
          "syn_count_ratio",
          "ack_count_ratio",
          "fin_count_ratio",
          "rst_count_ratio"
        ],
        "engineered_polynomial": [],
        "engineered_interaction": [
          "tcp_http_combo",
          "udp_dns_combo",
          "rate_ttl_interaction",
          "size_rate_interaction"
        ],
        "engineered_log": [
          "log_rate",
          "log_tot_size",
          "log_number"
        ]
      },
      "scaler": "RobustScaler",
      "balancing_method": "smote",
      "output": {
        "type": "binary",
        "classes": [
          "Benign",
          "Attack"
        ],
        "num_classes": 2
      }
    },
    "stage2": {
      "description": "Multi-class attack categorization",
      "input_features": [
        "Header_Length",
        "Protocol Type",
        "Time_To_Live",
        "Rate",
        "fin_flag_number",
        "syn_flag_number",
        "rst_flag_number",
        "psh_flag_number",
        "ack_flag_number",
        "ece_flag_number",
        "cwr_flag_number",
        "ack_count",
        "syn_count",
        "fin_count",
        "rst_count",
        "HTTP",
        "HTTPS",
        "DNS",
        "Telnet",
        "SMTP",
        "SSH",
        "IRC",
        "TCP",
        "UDP",
        "DHCP",
        "ARP",
        "ICMP",
        "IGMP",
        "IPv",
        "LLC",
        "Tot sum",
        "Min",
        "Max",
        "AVG",
        "Std",
        "Tot size",
        "IAT",
        "Number",
        "Variance",
        "syn_ack_ratio",
        "rst_fin_ratio",
        "psh_ack_ratio",
        "packet_rate_ratio",
        "size_per_packet",
        "avg_iat",
        "variance_avg_ratio",
        "std_avg_ratio",
        "range_stat",
        "cv",
        "flags_total",
        "flag_diversity",
        "tcp_http_combo",
        "udp_dns_combo",
        "protocol_count",
        "ttl_rate_ratio",
        "header_size_ratio",
        "syn_count_ratio",
        "ack_count_ratio",
        "fin_count_ratio",
        "rst_count_ratio",
        "rate_ttl_interaction",
        "size_rate_interaction",
        "log_rate",
        "log_tot_size",
        "log_number",
        "iat_variance",
        "iat_std",
        "burst_score"
      ],
      "num_features": 68,
      "scaler": "RobustScaler",
      "balancing_method": "smote_undersampling",
      "label_encoder": {
        "classes": [
          "BruteForce",
          "DDoS-DoS",
          "Mirai",
          "Reconnaissance",
          "Spoofing",
          "Web-Based"
        ],
        "num_classes": 6
      },
      "output": {
        "type": "multiclass",
        "classes": [
          "BruteForce",
          "DDoS-DoS",
          "Mirai",
          "Reconnaissance",
          "Spoofing",
          "Web-Based"
        ],
        "num_classes": 6
      }
    }
  },
  "feature_statistics": {
    "total_features": 68,
    "original_features_count": 45,
    "engineered_features_count": 23,
    "feature_categories": {
      "statistical": 15,
      "polynomial": 0,
      "interaction": 4,
      "logarithmic": 3
    },
    "all_features": [
      "Header_Length",
      "Protocol Type",
      "Time_To_Live",
      "Rate",
      "fin_flag_number",
      "syn_flag_number",
      "rst_flag_number",
      "psh_flag_number",
      "ack_flag_number",
      "ece_flag_number",
      "cwr_flag_number",
      "ack_count",
      "syn_count",
      "fin_count",
      "rst_count",
      "HTTP",
      "HTTPS",
      "DNS",
      "Telnet",
      "SMTP",
      "SSH",
      "IRC",
      "TCP",
      "UDP",
      "DHCP",
      "ARP",
      "ICMP",
      "IGMP",
      "IPv",
      "LLC",
      "Tot sum",
      "Min",
      "Max",
      "AVG",
      "Std",
      "Tot size",
      "IAT",
      "Number",
      "Variance",
      "syn_ack_ratio",
      "rst_fin_ratio",
      "psh_ack_ratio",
      "packet_rate_ratio",
      "size_per_packet",
      "avg_iat",
      "variance_avg_ratio",
      "std_avg_ratio",
      "range_stat",
      "cv",
      "flags_total",
      "flag_diversity",
      "tcp_http_combo",
      "udp_dns_combo",
      "protocol_count",
      "ttl_rate_ratio",
      "header_size_ratio",
      "syn_count_ratio",
      "ack_count_ratio",
      "fin_count_ratio",
      "rst_count_ratio",
      "rate_ttl_interaction",
      "size_rate_interaction",
      "log_rate",
      "log_tot_size",
      "log_number",
      "iat_variance",
      "iat_std",
      "burst_score"
    ]
  }
}