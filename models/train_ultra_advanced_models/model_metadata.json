{
  "model_info": {
    "name": "IoTGuard Ultra Advanced 2-Stage Ensemble",
    "version": "2.0",
    "architecture": "2-Stage: Binary + Multi-Class Classification",
    "created_at": "2025-12-14T20:47:20.285354",
    "training_duration": "0:20:56.928860",
    "framework": "LightGBM + XGBoost + CatBoost + TensorFlow",
    "dataset": "CIC-IoT-2023"
  },
  "training_data": {
    "train_samples": 392552,
    "val_samples": 265687,
    "test_samples": 272118,
    "train_files": 12,
    "val_files": 5,
    "test_files": 5,
    "dataset_name": "CIC-IoT-2023"
  },
  "stage1_binary": {
    "purpose": "Binary classification (Benign vs Attack)",
    "models": [
      "lightgbm",
      "xgboost",
      "catboost",
      "neural_network"
    ],
    "ensemble_weights": {
      "lightgbm": 0.32,
      "xgboost": 0.46,
      "catboost": 0.14,
      "neural_network": 0.08
    },
    "performance": {
      "accuracy": 0.9044385156439486,
      "precision": 0.9080007983909352,
      "recall": 0.956709536520262,
      "f1_score": 0.9317189986293385,
      "mcc": 0.7758676730772762,
      "confusion_matrix": [
        [
          68697,
          17976
        ],
        [
          8028,
          177417
        ]
      ]
    },
    "hyperparameters": {
      "lightgbm": {
        "enabled": true,
        "num_leaves": 120,
        "max_depth": 15,
        "learning_rate": 0.028,
        "n_estimators": 750,
        "min_child_samples": 7,
        "subsample": 0.88,
        "colsample_bytree": 0.88,
        "reg_alpha": 0.003,
        "reg_lambda": 0.003,
        "class_weight": "balanced",
        "is_unbalance": true
      },
      "xgboost": {
        "enabled": true,
        "max_depth": 15,
        "learning_rate": 0.028,
        "n_estimators": 750,
        "min_child_weight": 1,
        "subsample": 0.88,
        "colsample_bytree": 0.88,
        "gamma": 0.003,
        "reg_alpha": 0.003,
        "reg_lambda": 0.07,
        "scale_pos_weight": 7.5,
        "tree_method": "hist",
        "device": "cuda"
      },
      "catboost": {
        "enabled": true,
        "depth": 12,
        "learning_rate": 0.023,
        "iterations": 750,
        "l2_leaf_reg": 2.0,
        "border_count": 128,
        "random_strength": 0.5
      },
      "neural_network": {
        "enabled": true,
        "hidden_layers": [
          320,
          160,
          80,
          40
        ],
        "dropout_rate": 0.28,
        "activation": "relu",
        "optimizer": "adam",
        "learning_rate": 0.0009,
        "batch_size": 1024,
        "epochs": 55,
        "early_stopping_patience": 12
      }
    }
  },
  "stage2_multiclass": {
    "purpose": "Multi-class attack categorization",
    "models": [
      "lightgbm",
      "xgboost",
      "catboost"
    ],
    "ensemble_weights": {
      "lightgbm": 0.36,
      "xgboost": 0.44,
      "catboost": 0.2
    },
    "attack_categories": [
      "BruteForce",
      "DDoS-DoS",
      "Mirai",
      "Reconnaissance",
      "Spoofing",
      "Web-Based"
    ],
    "n_classes": 6,
    "performance": {
      "accuracy": 0.9644509827130433,
      "precision": 0.9623368581361589,
      "recall": 0.9644509827130433,
      "f1_score": 0.962992892132076,
      "confusion_matrix": [
        [
          396,
          0,
          0,
          420,
          80,
          23
        ],
        [
          0,
          47935,
          61,
          4,
          0,
          0
        ],
        [
          0,
          30,
          47970,
          0,
          0,
          0
        ],
        [
          190,
          0,
          0,
          40275,
          1485,
          331
        ],
        [
          48,
          0,
          0,
          2132,
          34033,
          227
        ],
        [
          11,
          0,
          0,
          1092,
          173,
          501
        ]
      ]
    },
    "hyperparameters": {
      "lightgbm": {
        "enabled": true,
        "num_leaves": 120,
        "max_depth": 16,
        "learning_rate": 0.023,
        "n_estimators": 800,
        "min_child_samples": 3,
        "subsample": 0.88,
        "colsample_bytree": 0.88,
        "reg_alpha": 0.003,
        "reg_lambda": 0.003,
        "class_weight": "balanced",
        "is_unbalance": true
      },
      "xgboost": {
        "enabled": true,
        "max_depth": 16,
        "learning_rate": 0.023,
        "n_estimators": 800,
        "min_child_weight": 1,
        "subsample": 0.88,
        "colsample_bytree": 0.88,
        "gamma": 0.003,
        "reg_alpha": 0.003,
        "reg_lambda": 0.07,
        "tree_method": "hist",
        "device": "cuda"
      },
      "catboost": {
        "enabled": true,
        "depth": 12,
        "learning_rate": 0.018,
        "iterations": 800,
        "l2_leaf_reg": 2.0,
        "border_count": 128,
        "random_strength": 0.5,
        "class_weights": [
          1,
          1,
          1,
          1,
          1,
          1
        ]
      }
    }
  },
  "full_pipeline": {
    "accuracy": 0.628808090607751,
    "precision": 0.6541983073319895,
    "recall": 0.628808090607751,
    "f1_score": 0.6406821344324888,
    "benign_detection_rate": 1.0,
    "attack_detection_rate": 0.956709536520262,
    "total_test_samples": 272118,
    "benign_samples": 86673,
    "attack_samples": 185445
  },
  "feature_engineering": {
    "original_features": 39,
    "engineered_features": 29,
    "total_features": 68,
    "feature_types": {
      "statistical": true,
      "time_based": true,
      "polynomial": false
    }
  },
  "files": {
    "stage1_model": "models/train_ultra_advanced_models/ultra_advanced_stage1_ensemble.pkl",
    "stage2_model": "models/train_ultra_advanced_models/ultra_advanced_stage2_ensemble.pkl",
    "config": "config_train_ultra_advanced.yaml",
    "results_dir": "results/train_ultra_advanced_results/"
  },
  "stage1_nn": {},
  "model_inputs": {
    "stage1": {
      "description": "Binary classification (Benign vs Attack)",
      "input_features": [
        "Header_Length",
        "Protocol Type",
        "Time_To_Live",
        "Rate",
        "fin_flag_number",
        "syn_flag_number",
        "rst_flag_number",
        "psh_flag_number",
        "ack_flag_number",
        "ece_flag_number",
        "cwr_flag_number",
        "ack_count",
        "syn_count",
        "fin_count",
        "rst_count",
        "HTTP",
        "HTTPS",
        "DNS",
        "Telnet",
        "SMTP",
        "SSH",
        "IRC",
        "TCP",
        "UDP",
        "DHCP",
        "ARP",
        "ICMP",
        "IGMP",
        "IPv",
        "LLC",
        "Tot sum",
        "Min",
        "Max",
        "AVG",
        "Std",
        "Tot size",
        "IAT",
        "Number",
        "Variance",
        "syn_ack_ratio",
        "rst_fin_ratio",
        "psh_ack_ratio",
        "packet_rate_ratio",
        "size_per_packet",
        "avg_iat",
        "variance_avg_ratio",
        "std_avg_ratio",
        "range_stat",
        "cv",
        "flags_total",
        "flag_diversity",
        "tcp_http_combo",
        "udp_dns_combo",
        "protocol_count",
        "ttl_rate_ratio",
        "header_size_ratio",
        "syn_count_ratio",
        "ack_count_ratio",
        "fin_count_ratio",
        "rst_count_ratio",
        "rate_ttl_interaction",
        "size_rate_interaction",
        "log_rate",
        "log_tot_size",
        "log_number",
        "iat_variance",
        "iat_std",
        "burst_score"
      ],
      "num_features": 68,
      "feature_types": {
        "original": [
          "Header_Length",
          "Protocol Type",
          "Time_To_Live",
          "Rate",
          "fin_flag_number",
          "syn_flag_number",
          "rst_flag_number",
          "psh_flag_number",
          "ack_flag_number",
          "ece_flag_number",
          "cwr_flag_number",
          "ack_count",
          "syn_count",
          "fin_count",
          "rst_count",
          "HTTP",
          "HTTPS",
          "DNS",
          "Telnet",
          "SMTP",
          "SSH",
          "IRC",
          "TCP",
          "UDP",
          "DHCP",
          "ARP",
          "ICMP",
          "IGMP",
          "IPv",
          "LLC",
          "Tot sum",
          "Min",
          "Max",
          "AVG",
          "Std",
          "Tot size",
          "IAT",
          "Number",
          "Variance",
          "size_per_packet",
          "avg_iat",
          "flags_total",
          "protocol_count",
          "iat_variance",
          "iat_std"
        ],
        "engineered_statistical": [
          "syn_ack_ratio",
          "rst_fin_ratio",
          "psh_ack_ratio",
          "packet_rate_ratio",
          "variance_avg_ratio",
          "std_avg_ratio",
          "range_stat",
          "cv",
          "flag_diversity",
          "ttl_rate_ratio",
          "header_size_ratio",
          "syn_count_ratio",
          "ack_count_ratio",
          "fin_count_ratio",
          "rst_count_ratio"
        ],
        "engineered_polynomial": [],
        "engineered_interaction": [
          "tcp_http_combo",
          "udp_dns_combo",
          "rate_ttl_interaction",
          "size_rate_interaction"
        ],
        "engineered_log": [
          "log_rate",
          "log_tot_size",
          "log_number"
        ]
      },
      "scaler": "RobustScaler",
      "balancing_method": "smote",
      "output": {
        "type": "binary",
        "classes": [
          "Benign",
          "Attack"
        ],
        "num_classes": 2
      }
    },
    "stage2": {
      "description": "Multi-class attack categorization",
      "input_features": [
        "Header_Length",
        "Protocol Type",
        "Time_To_Live",
        "Rate",
        "fin_flag_number",
        "syn_flag_number",
        "rst_flag_number",
        "psh_flag_number",
        "ack_flag_number",
        "ece_flag_number",
        "cwr_flag_number",
        "ack_count",
        "syn_count",
        "fin_count",
        "rst_count",
        "HTTP",
        "HTTPS",
        "DNS",
        "Telnet",
        "SMTP",
        "SSH",
        "IRC",
        "TCP",
        "UDP",
        "DHCP",
        "ARP",
        "ICMP",
        "IGMP",
        "IPv",
        "LLC",
        "Tot sum",
        "Min",
        "Max",
        "AVG",
        "Std",
        "Tot size",
        "IAT",
        "Number",
        "Variance",
        "syn_ack_ratio",
        "rst_fin_ratio",
        "psh_ack_ratio",
        "packet_rate_ratio",
        "size_per_packet",
        "avg_iat",
        "variance_avg_ratio",
        "std_avg_ratio",
        "range_stat",
        "cv",
        "flags_total",
        "flag_diversity",
        "tcp_http_combo",
        "udp_dns_combo",
        "protocol_count",
        "ttl_rate_ratio",
        "header_size_ratio",
        "syn_count_ratio",
        "ack_count_ratio",
        "fin_count_ratio",
        "rst_count_ratio",
        "rate_ttl_interaction",
        "size_rate_interaction",
        "log_rate",
        "log_tot_size",
        "log_number",
        "iat_variance",
        "iat_std",
        "burst_score"
      ],
      "num_features": 68,
      "scaler": "RobustScaler",
      "balancing_method": "smote_undersampling",
      "label_encoder": {
        "classes": [
          "BruteForce",
          "DDoS-DoS",
          "Mirai",
          "Reconnaissance",
          "Spoofing",
          "Web-Based"
        ],
        "num_classes": 6
      },
      "output": {
        "type": "multiclass",
        "classes": [
          "BruteForce",
          "DDoS-DoS",
          "Mirai",
          "Reconnaissance",
          "Spoofing",
          "Web-Based"
        ],
        "num_classes": 6
      }
    }
  },
  "feature_statistics": {
    "total_features": 68,
    "original_features_count": 45,
    "engineered_features_count": 23,
    "feature_categories": {
      "statistical": 15,
      "polynomial": 0,
      "interaction": 4,
      "logarithmic": 3
    },
    "all_features": [
      "Header_Length",
      "Protocol Type",
      "Time_To_Live",
      "Rate",
      "fin_flag_number",
      "syn_flag_number",
      "rst_flag_number",
      "psh_flag_number",
      "ack_flag_number",
      "ece_flag_number",
      "cwr_flag_number",
      "ack_count",
      "syn_count",
      "fin_count",
      "rst_count",
      "HTTP",
      "HTTPS",
      "DNS",
      "Telnet",
      "SMTP",
      "SSH",
      "IRC",
      "TCP",
      "UDP",
      "DHCP",
      "ARP",
      "ICMP",
      "IGMP",
      "IPv",
      "LLC",
      "Tot sum",
      "Min",
      "Max",
      "AVG",
      "Std",
      "Tot size",
      "IAT",
      "Number",
      "Variance",
      "syn_ack_ratio",
      "rst_fin_ratio",
      "psh_ack_ratio",
      "packet_rate_ratio",
      "size_per_packet",
      "avg_iat",
      "variance_avg_ratio",
      "std_avg_ratio",
      "range_stat",
      "cv",
      "flags_total",
      "flag_diversity",
      "tcp_http_combo",
      "udp_dns_combo",
      "protocol_count",
      "ttl_rate_ratio",
      "header_size_ratio",
      "syn_count_ratio",
      "ack_count_ratio",
      "fin_count_ratio",
      "rst_count_ratio",
      "rate_ttl_interaction",
      "size_rate_interaction",
      "log_rate",
      "log_tot_size",
      "log_number",
      "iat_variance",
      "iat_std",
      "burst_score"
    ]
  }
}